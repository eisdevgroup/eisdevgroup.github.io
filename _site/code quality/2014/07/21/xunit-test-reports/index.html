
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>xUnit test reports for sbt</title>
    <meta name="description" content="xUnit test reports integration for Jenkins and jacoco4sbt.">
    <meta name="author" content="EIS devteam">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <meta name='yandex-verification' content='613133660773ed96' />
    <meta name="google-site-verification" content="CPQmKg1jFC7I9tyi_QwTHTAsX60o4STZ4vs9zOlXYMA" />
    <meta name='wmail-verification' content='e93774c6ccee23da' />
    <meta name="msvalidate.01" content="EE48A706A4A7D2F331EEF8A086011F10" />

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap3.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
<!--     <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">EIS Development Team Blog</a>
          <ul class="nav">
            <li><a href="/index.html">Главная</a></li>
            <li><a href="/blog.html">Блог</a></li>
            <li><a href="/categories.html">Категории</a></li>
            <li><a href="/tags.html">Тэги</a></li>
            <li><a href="/archive.html">Архив</a></li>
          </ul>
        </div>
      </div>
    </div> -->
    <div class="navbar navbar-default navbar-static-top" role="navigation">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">EIS Development Team Blog</a>
        </div>
        <div class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/index.html">Главная</a></li>
            <li><a href="/blog.html">Блог</a></li>
            <li><a href="/categories.html">Категории</a></li>
            <li><a href="/tags.html">Тэги</a></li>
            <li><a href="/archive.html">Архив</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>xUnit test reports for sbt </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>21 July 2014</span>
    </div>
    <div class="content">
      
<h2 id="xunit">Отчеты о прохождении тестов в формате xUnit</h2>

<h3 id="jenkins">Отчеты и Jenkins</h3>

<p>Для Jenkins существует <a href="https://wiki.jenkins-ci.org/display/JENKINS/xUnit+Plugin">плагин</a>, разбирающий отчеты в формает xUnit. XML-отчет преобразуется в таблицу соответствия тестов и результатов.
Кроме того плагин позволяет отследить динамику прохождения тестов и их количества в виде графиков и таблицы на странице задачи Jenkins (сколько тестов добавлено в последней сборке, сколько тестов сломалось за последний месяц,…).
Визуализация отчетов позволяет быстрее локализовать место возможной ошибки и исправить ее (или тест).</p>

<h3 id="xunit--playframework">xUnit и PlayFramework</h3>

<p>К сожалению при настройках по умолчанию при прохождении тестов в PlayFramework xUnit отчет не создается, а формат отчета не совпадает с xUnit. В официальной документации на сайте информации о создании подобных отчетов нет.</p>

<p>Однако, в действительности, отчет в формате xUnit создать можно. Как оказалось эта возможность заложена в sbt.
Для создания отчетов необходимо добавить следующий ключ в скрипт сборки в <em>Build.scala</em>:</p>

<pre><code>testOptions in Test += Tests.Argument("junitxml", "console")
</code></pre>

<p>При следующем выполнении команды <em>sbt test</em> будет создан файл отчета в папке <em>$PROJECT/target/test-reports</em>.</p>

<p>Остается установить плагин для Jenkins и добавть послесборочный шаг публикации отчетов JUnit.</p>

<h3 id="xunit--jacoco">xUnit и Jacoco</h3>

<p>Если Вы используете jacoco4sbt для сборки статистики покрытия тестов, то обнаружите, что XML отчет не формируется при запуске команд <em>jacoco:test</em> или <em>jacoco:cover</em>.
Проблема решается также просто:</p>

<ul>
  <li>Необходимо добавить в зависимости проекта библиотеку <em>junit-interface</em>. Эта же библиотека используется для генерации отчетов xUnit в PlayFramework</li>
</ul>

<div class="highlight"><pre><code class="scala">    <span class="k">val</span> <span class="n">junitInterface</span> <span class="k">=</span> <span class="s">&quot;com.novocode&quot;</span> <span class="o">%</span> <span class="s">&quot;junit-interface&quot;</span> <span class="o">%</span> <span class="s">&quot;0.10&quot;</span> <span class="o">%</span> <span class="s">&quot;test&quot;</span>
    <span class="c1">// Add to play project dependencies config</span>
    <span class="n">appDependencies</span> <span class="o">++</span> <span class="nc">Seq</span><span class="o">(</span><span class="n">junitInterface</span><span class="o">)</span>
</code></pre></div>

<ul>
  <li>Необходимо добавить ключ в конфигурацию сборки в <em>Build.scala</em>:</li>
</ul>

<div class="highlight"><pre><code class="scala">    <span class="n">testOptions</span> <span class="n">in</span> <span class="n">jacoco</span><span class="o">.</span><span class="nc">Config</span> <span class="o">+=</span> <span class="nc">Tests</span><span class="o">.</span><span class="nc">Argument</span><span class="o">(</span><span class="s">&quot;junitxml&quot;</span><span class="o">,</span> <span class="s">&quot;console&quot;</span><span class="o">)</span>
</code></pre></div>

<p>После перезагрузки описания проекта при выполнении команд <em>jacoco:test</em> или <em>jacoco:cover</em> Вы получите отчета в папке <em>$PROJECT/target/test-reports</em>.</p>

<h3 id="section">Ссылки</h3>

<p><a href="https://wiki.jenkins-ci.org/display/JENKINS/xUnit+Plugin">xUnit plugin</a></p>

<p><a href="https://github.com/sbt/junit-interface">jUnit interface</a></p>

    </div>

  
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      
      


  
     
    	<li><a href="/categories.html#code quality-ref">
    		code quality <span>2</span>
    	</a></li>
    
  


    </ul>
  

  
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      
      


  
     
    	<li><a href="/tags.html#scala-ref">scala <span>2</span></a></li>
     
    	<li><a href="/tags.html#code quality-ref">code quality <span>2</span></a></li>
     
    	<li><a href="/tags.html#ci-ref">ci <span>1</span></a></li>
    
  



    </ul>
  

    <hr>
<!--     <div class="pagination"> -->
      <ul class="pager">
      
        <li class="prev previous"><a href="/play%20framework/2014/07/04/azurejay" title="AzureJay">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next disabled"><a>Next &rarr;</a>
      
      </ul>
    <!-- div -->
    <hr>
    
  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2014 EIS devteam
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

